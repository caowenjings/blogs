<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue实战总结 | 静</title>
    <meta name="generator" content="VuePress 1.9.8">
    
    <meta name="description" content="每天进步一点点">
    
    <link rel="preload" href="/blogs/assets/css/0.styles.2b370ae1.css" as="style"><link rel="preload" href="/blogs/assets/js/app.318ed052.js" as="script"><link rel="preload" href="/blogs/assets/js/2.b253f094.js" as="script"><link rel="preload" href="/blogs/assets/js/78.3417b478.js" as="script"><link rel="prefetch" href="/blogs/assets/js/10.dcbb07c9.js"><link rel="prefetch" href="/blogs/assets/js/11.38fbba51.js"><link rel="prefetch" href="/blogs/assets/js/12.2ea56a59.js"><link rel="prefetch" href="/blogs/assets/js/13.0e9d039e.js"><link rel="prefetch" href="/blogs/assets/js/14.2d2bccdc.js"><link rel="prefetch" href="/blogs/assets/js/15.664c4ac5.js"><link rel="prefetch" href="/blogs/assets/js/16.d2aac269.js"><link rel="prefetch" href="/blogs/assets/js/17.ba84ddbb.js"><link rel="prefetch" href="/blogs/assets/js/18.485ea954.js"><link rel="prefetch" href="/blogs/assets/js/19.a66e908f.js"><link rel="prefetch" href="/blogs/assets/js/20.0b04d503.js"><link rel="prefetch" href="/blogs/assets/js/21.6be10f09.js"><link rel="prefetch" href="/blogs/assets/js/22.159acd7d.js"><link rel="prefetch" href="/blogs/assets/js/23.4f195fc5.js"><link rel="prefetch" href="/blogs/assets/js/24.7f87a588.js"><link rel="prefetch" href="/blogs/assets/js/25.5d5a6655.js"><link rel="prefetch" href="/blogs/assets/js/26.ae6e384a.js"><link rel="prefetch" href="/blogs/assets/js/27.242c2814.js"><link rel="prefetch" href="/blogs/assets/js/28.3a561971.js"><link rel="prefetch" href="/blogs/assets/js/29.5f10fcb0.js"><link rel="prefetch" href="/blogs/assets/js/3.3f822af5.js"><link rel="prefetch" href="/blogs/assets/js/30.936b6878.js"><link rel="prefetch" href="/blogs/assets/js/31.1347c229.js"><link rel="prefetch" href="/blogs/assets/js/32.d7feb56f.js"><link rel="prefetch" href="/blogs/assets/js/33.df5562d6.js"><link rel="prefetch" href="/blogs/assets/js/34.0c0a3c4a.js"><link rel="prefetch" href="/blogs/assets/js/35.986ca927.js"><link rel="prefetch" href="/blogs/assets/js/36.11d5619d.js"><link rel="prefetch" href="/blogs/assets/js/37.226a7009.js"><link rel="prefetch" href="/blogs/assets/js/38.d890e85c.js"><link rel="prefetch" href="/blogs/assets/js/39.3fea6c86.js"><link rel="prefetch" href="/blogs/assets/js/4.203b8c1d.js"><link rel="prefetch" href="/blogs/assets/js/40.ea2c4b60.js"><link rel="prefetch" href="/blogs/assets/js/41.c9ccd141.js"><link rel="prefetch" href="/blogs/assets/js/42.8681e81b.js"><link rel="prefetch" href="/blogs/assets/js/43.6722b2e0.js"><link rel="prefetch" href="/blogs/assets/js/44.6794f235.js"><link rel="prefetch" href="/blogs/assets/js/45.a40d2a94.js"><link rel="prefetch" href="/blogs/assets/js/46.661e6a50.js"><link rel="prefetch" href="/blogs/assets/js/47.b764e11a.js"><link rel="prefetch" href="/blogs/assets/js/48.44b2ca69.js"><link rel="prefetch" href="/blogs/assets/js/49.07d58d76.js"><link rel="prefetch" href="/blogs/assets/js/5.241843e3.js"><link rel="prefetch" href="/blogs/assets/js/50.c8d2e9af.js"><link rel="prefetch" href="/blogs/assets/js/51.33182cb5.js"><link rel="prefetch" href="/blogs/assets/js/52.ffc8990e.js"><link rel="prefetch" href="/blogs/assets/js/53.fe9f26ff.js"><link rel="prefetch" href="/blogs/assets/js/54.03f0e4ee.js"><link rel="prefetch" href="/blogs/assets/js/55.bcfe8e3c.js"><link rel="prefetch" href="/blogs/assets/js/56.e3679f22.js"><link rel="prefetch" href="/blogs/assets/js/57.fbec18db.js"><link rel="prefetch" href="/blogs/assets/js/58.7dfa5e6d.js"><link rel="prefetch" href="/blogs/assets/js/59.dda5f67e.js"><link rel="prefetch" href="/blogs/assets/js/6.181d1f0e.js"><link rel="prefetch" href="/blogs/assets/js/60.270ae626.js"><link rel="prefetch" href="/blogs/assets/js/61.6a2c3e9b.js"><link rel="prefetch" href="/blogs/assets/js/62.9990c1e5.js"><link rel="prefetch" href="/blogs/assets/js/63.5fbd0e7f.js"><link rel="prefetch" href="/blogs/assets/js/64.ea80a730.js"><link rel="prefetch" href="/blogs/assets/js/65.9bda3580.js"><link rel="prefetch" href="/blogs/assets/js/66.6976f074.js"><link rel="prefetch" href="/blogs/assets/js/67.6421fc3e.js"><link rel="prefetch" href="/blogs/assets/js/68.3c9a69d8.js"><link rel="prefetch" href="/blogs/assets/js/69.e2d07711.js"><link rel="prefetch" href="/blogs/assets/js/7.8d512ac6.js"><link rel="prefetch" href="/blogs/assets/js/70.686ebe8e.js"><link rel="prefetch" href="/blogs/assets/js/71.50a43118.js"><link rel="prefetch" href="/blogs/assets/js/72.3c0b4a7f.js"><link rel="prefetch" href="/blogs/assets/js/73.74d2bda0.js"><link rel="prefetch" href="/blogs/assets/js/74.f1003cb4.js"><link rel="prefetch" href="/blogs/assets/js/75.c1f4c98b.js"><link rel="prefetch" href="/blogs/assets/js/76.4dc3f570.js"><link rel="prefetch" href="/blogs/assets/js/77.5f8de3e2.js"><link rel="prefetch" href="/blogs/assets/js/79.92ee8e13.js"><link rel="prefetch" href="/blogs/assets/js/8.2ea5d4ca.js"><link rel="prefetch" href="/blogs/assets/js/80.d54c6762.js"><link rel="prefetch" href="/blogs/assets/js/9.df6f0129.js">
    <link rel="stylesheet" href="/blogs/assets/css/0.styles.2b370ae1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blogs/" class="home-link router-link-active"><img src="./public/head.png" alt="静" class="logo"> <span class="site-name can-hide">静</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blogs/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="js" class="dropdown-title"><span class="title">js</span> <span class="arrow down"></span></button> <button type="button" aria-label="js" class="mobile-dropdown-title"><span class="title">js</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/js/js/" class="nav-link">
  js杂记
</a></li><li class="dropdown-item"><!----> <a href="/blogs/js/promise/" class="nav-link">
  Promise规范和应用
</a></li><li class="dropdown-item"><!----> <a href="/blogs/js/browser/" class="nav-link">
  浏览器对象详解
</a></li><li class="dropdown-item"><!----> <a href="/blogs/js/js_oop/" class="nav-link">
  面向对象编程
</a></li><li class="dropdown-item"><!----> <a href="/blogs/js/es6/" class="nav-link">
  ES6及ESNext规范详解
</a></li><li class="dropdown-item"><!----> <a href="/blogs/js/this/" class="nav-link">
  this指向、作用域、闭包
</a></li><li class="dropdown-item"><!----> <a href="/blogs/js/git/" class="nav-link">
  git使用
</a></li><li class="dropdown-item"><!----> <a href="/blogs/ts/typeScript/" class="nav-link">
  ts初探
</a></li><li class="dropdown-item"><!----> <a href="/blogs/ts/tsBasic/" class="nav-link">
  ts基础
</a></li><li class="dropdown-item"><!----> <a href="/blogs/ts/tsProject/" class="nav-link">
  ts工程
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工程化" class="dropdown-title"><span class="title">工程化</span> <span class="arrow down"></span></button> <button type="button" aria-label="工程化" class="mobile-dropdown-title"><span class="title">工程化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/js/js_module/" class="nav-link">
  模块化规范
</a></li><li class="dropdown-item"><!----> <a href="/blogs/js/js_project/" class="nav-link">
  前端工程化详解
</a></li><li class="dropdown-item"><!----> <a href="/blogs/project/webpack/" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/blogs/project/babel/" class="nav-link">
  babel
</a></li><li class="dropdown-item"><!----> <a href="/blogs/tools/autotest/" class="nav-link">
  自动化测试和部署
</a></li><li class="dropdown-item"><!----> <a href="/blogs/tools/ast/" class="nav-link">
  AST解析
</a></li><li class="dropdown-item"><!----> <a href="/blogs/tools/solution/" class="nav-link">
  前端方案
</a></li><li class="dropdown-item"><!----> <a href="/blogs/tools/js_tools/" class="nav-link">
  常用工具
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue" class="dropdown-title"><span class="title">vue</span> <span class="arrow down"></span></button> <button type="button" aria-label="vue" class="mobile-dropdown-title"><span class="title">vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-basic/" class="nav-link">
  vue2.0基础
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-advance/" class="nav-link">
  vue2.0进阶
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-cli/" class="nav-link">
  vue-cli详解
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-loader/" class="nav-link">
  vue-loader
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-router/" class="nav-link">
  vue-router
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vuex/" class="nav-link">
  vuex
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-ssr/" class="nav-link">
  vue-ssr
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-i18n/" class="nav-link">
  vue-i18n
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-life/" class="nav-link">
  vue生命周期
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-reactive/" class="nav-link">
  响应式原理
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-diff/" class="nav-link">
  diff原理
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-compiler/" class="nav-link">
  编译原理
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-refs/" class="nav-link">
  vue实战总结
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="react" class="dropdown-title"><span class="title">react</span> <span class="arrow down"></span></button> <button type="button" aria-label="react" class="mobile-dropdown-title"><span class="title">react</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/react/react/" class="nav-link">
  react基础
</a></li><li class="dropdown-item"><!----> <a href="/blogs/react/react-advance/" class="nav-link">
  react进阶
</a></li><li class="dropdown-item"><!----> <a href="/blogs/react/react-router/" class="nav-link">
  react-router
</a></li><li class="dropdown-item"><!----> <a href="/blogs/react/react-state/" class="nav-link">
  react-状态管理
</a></li><li class="dropdown-item"><!----> <a href="/blogs/react/react-ssr/" class="nav-link">
  react同构
</a></li><li class="dropdown-item"><!----> <a href="/blogs/react/react-component/" class="nav-link">
  react组件封装
</a></li><li class="dropdown-item"><!----> <a href="/blogs/react/react-code/" class="nav-link">
  react源码分析
</a></li><li class="dropdown-item"><!----> <a href="/blogs/react/react-question/" class="nav-link">
  react问题整理
</a></li><li class="dropdown-item"><!----> <a href="/blogs/react/react-ts-project/" class="nav-link">
  react-ts实战
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="nodejs" class="dropdown-title"><span class="title">nodejs</span> <span class="arrow down"></span></button> <button type="button" aria-label="nodejs" class="mobile-dropdown-title"><span class="title">nodejs</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/nodejs/basic/" class="nav-link">
  nodejs基础
</a></li><li class="dropdown-item"><!----> <a href="/blogs/nodejs/module/" class="nav-link">
  node常用框架
</a></li><li class="dropdown-item"><!----> <a href="/blogs/nodejs/http/" class="nav-link">
  nodejs网络及部署
</a></li><li class="dropdown-item"><!----> <a href="/blogs/nodejs/express-ts/" class="nav-link">
  express-ts实战
</a></li><li class="dropdown-item"><!----> <a href="/blogs/nodejs/info/" class="nav-link">
  Nodejs前研
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/frontend/interview/" class="nav-link">
  前端面试
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/performance/" class="nav-link">
  前端性能优化
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/explorer/" class="nav-link">
  浏览器进程和线程
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/security-control/" class="nav-link">
  前端网络安全
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/lowcode/" class="nav-link">
  低代码平台
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/micro-frontend/" class="nav-link">
  微前端
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/designMode/" class="nav-link">
  前端设计模式
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/css/" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/mini-program/" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/hybrid/" class="nav-link">
  Hybrid开发及原理
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/canvas/" class="nav-link">
  canvas
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/graph/" class="nav-link">
  图片格式
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/web3/" class="nav-link">
  web3探索
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/algorithm/graph/" class="nav-link">
  图的存储和遍历
</a></li><li class="dropdown-item"><!----> <a href="/blogs/algorithm/dpointer/" class="nav-link">
  双指针
</a></li><li class="dropdown-item"><!----> <a href="/blogs/algorithm/levenshtein/" class="nav-link">
  最端编辑距离算法
</a></li><li class="dropdown-item"><!----> <a href="/blogs/algorithm/greed/" class="nav-link">
  贪心算法
</a></li><li class="dropdown-item"><!----> <a href="/blogs/algorithm/dp/" class="nav-link">
  动态规划
</a></li><li class="dropdown-item"><!----> <a href="/blogs/algorithm/leetcode/" class="nav-link">
  leetcode
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/backend/nginx/" class="nav-link">
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/blogs/backend/springboot/" class="nav-link">
  Springboot
</a></li><li class="dropdown-item"><!----> <a href="/blogs/backend/mybatis/" class="nav-link">
  mybatis
</a></li><li class="dropdown-item"><!----> <a href="/blogs/backend/uml/" class="nav-link">
  uml类图
</a></li><li class="dropdown-item"><!----> <a href="/blogs/backend/ddd/" class="nav-link">
  领域驱动设计
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="友链" class="dropdown-title"><span class="title">友链</span> <span class="arrow down"></span></button> <button type="button" aria-label="友链" class="mobile-dropdown-title"><span class="title">友链</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://lxchuan12.gitee.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  若川博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://www.inode.club/interview/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  程序员成长指北-node，面
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blogs/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="js" class="dropdown-title"><span class="title">js</span> <span class="arrow down"></span></button> <button type="button" aria-label="js" class="mobile-dropdown-title"><span class="title">js</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/js/js/" class="nav-link">
  js杂记
</a></li><li class="dropdown-item"><!----> <a href="/blogs/js/promise/" class="nav-link">
  Promise规范和应用
</a></li><li class="dropdown-item"><!----> <a href="/blogs/js/browser/" class="nav-link">
  浏览器对象详解
</a></li><li class="dropdown-item"><!----> <a href="/blogs/js/js_oop/" class="nav-link">
  面向对象编程
</a></li><li class="dropdown-item"><!----> <a href="/blogs/js/es6/" class="nav-link">
  ES6及ESNext规范详解
</a></li><li class="dropdown-item"><!----> <a href="/blogs/js/this/" class="nav-link">
  this指向、作用域、闭包
</a></li><li class="dropdown-item"><!----> <a href="/blogs/js/git/" class="nav-link">
  git使用
</a></li><li class="dropdown-item"><!----> <a href="/blogs/ts/typeScript/" class="nav-link">
  ts初探
</a></li><li class="dropdown-item"><!----> <a href="/blogs/ts/tsBasic/" class="nav-link">
  ts基础
</a></li><li class="dropdown-item"><!----> <a href="/blogs/ts/tsProject/" class="nav-link">
  ts工程
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工程化" class="dropdown-title"><span class="title">工程化</span> <span class="arrow down"></span></button> <button type="button" aria-label="工程化" class="mobile-dropdown-title"><span class="title">工程化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/js/js_module/" class="nav-link">
  模块化规范
</a></li><li class="dropdown-item"><!----> <a href="/blogs/js/js_project/" class="nav-link">
  前端工程化详解
</a></li><li class="dropdown-item"><!----> <a href="/blogs/project/webpack/" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/blogs/project/babel/" class="nav-link">
  babel
</a></li><li class="dropdown-item"><!----> <a href="/blogs/tools/autotest/" class="nav-link">
  自动化测试和部署
</a></li><li class="dropdown-item"><!----> <a href="/blogs/tools/ast/" class="nav-link">
  AST解析
</a></li><li class="dropdown-item"><!----> <a href="/blogs/tools/solution/" class="nav-link">
  前端方案
</a></li><li class="dropdown-item"><!----> <a href="/blogs/tools/js_tools/" class="nav-link">
  常用工具
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue" class="dropdown-title"><span class="title">vue</span> <span class="arrow down"></span></button> <button type="button" aria-label="vue" class="mobile-dropdown-title"><span class="title">vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-basic/" class="nav-link">
  vue2.0基础
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-advance/" class="nav-link">
  vue2.0进阶
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-cli/" class="nav-link">
  vue-cli详解
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-loader/" class="nav-link">
  vue-loader
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-router/" class="nav-link">
  vue-router
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vuex/" class="nav-link">
  vuex
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-ssr/" class="nav-link">
  vue-ssr
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-i18n/" class="nav-link">
  vue-i18n
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-life/" class="nav-link">
  vue生命周期
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-reactive/" class="nav-link">
  响应式原理
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-diff/" class="nav-link">
  diff原理
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-compiler/" class="nav-link">
  编译原理
</a></li><li class="dropdown-item"><!----> <a href="/blogs/vue/vue-refs/" class="nav-link">
  vue实战总结
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="react" class="dropdown-title"><span class="title">react</span> <span class="arrow down"></span></button> <button type="button" aria-label="react" class="mobile-dropdown-title"><span class="title">react</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/react/react/" class="nav-link">
  react基础
</a></li><li class="dropdown-item"><!----> <a href="/blogs/react/react-advance/" class="nav-link">
  react进阶
</a></li><li class="dropdown-item"><!----> <a href="/blogs/react/react-router/" class="nav-link">
  react-router
</a></li><li class="dropdown-item"><!----> <a href="/blogs/react/react-state/" class="nav-link">
  react-状态管理
</a></li><li class="dropdown-item"><!----> <a href="/blogs/react/react-ssr/" class="nav-link">
  react同构
</a></li><li class="dropdown-item"><!----> <a href="/blogs/react/react-component/" class="nav-link">
  react组件封装
</a></li><li class="dropdown-item"><!----> <a href="/blogs/react/react-code/" class="nav-link">
  react源码分析
</a></li><li class="dropdown-item"><!----> <a href="/blogs/react/react-question/" class="nav-link">
  react问题整理
</a></li><li class="dropdown-item"><!----> <a href="/blogs/react/react-ts-project/" class="nav-link">
  react-ts实战
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="nodejs" class="dropdown-title"><span class="title">nodejs</span> <span class="arrow down"></span></button> <button type="button" aria-label="nodejs" class="mobile-dropdown-title"><span class="title">nodejs</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/nodejs/basic/" class="nav-link">
  nodejs基础
</a></li><li class="dropdown-item"><!----> <a href="/blogs/nodejs/module/" class="nav-link">
  node常用框架
</a></li><li class="dropdown-item"><!----> <a href="/blogs/nodejs/http/" class="nav-link">
  nodejs网络及部署
</a></li><li class="dropdown-item"><!----> <a href="/blogs/nodejs/express-ts/" class="nav-link">
  express-ts实战
</a></li><li class="dropdown-item"><!----> <a href="/blogs/nodejs/info/" class="nav-link">
  Nodejs前研
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/frontend/interview/" class="nav-link">
  前端面试
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/performance/" class="nav-link">
  前端性能优化
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/explorer/" class="nav-link">
  浏览器进程和线程
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/security-control/" class="nav-link">
  前端网络安全
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/lowcode/" class="nav-link">
  低代码平台
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/micro-frontend/" class="nav-link">
  微前端
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/designMode/" class="nav-link">
  前端设计模式
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/css/" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/mini-program/" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/hybrid/" class="nav-link">
  Hybrid开发及原理
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/canvas/" class="nav-link">
  canvas
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/graph/" class="nav-link">
  图片格式
</a></li><li class="dropdown-item"><!----> <a href="/blogs/frontend/web3/" class="nav-link">
  web3探索
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/algorithm/graph/" class="nav-link">
  图的存储和遍历
</a></li><li class="dropdown-item"><!----> <a href="/blogs/algorithm/dpointer/" class="nav-link">
  双指针
</a></li><li class="dropdown-item"><!----> <a href="/blogs/algorithm/levenshtein/" class="nav-link">
  最端编辑距离算法
</a></li><li class="dropdown-item"><!----> <a href="/blogs/algorithm/greed/" class="nav-link">
  贪心算法
</a></li><li class="dropdown-item"><!----> <a href="/blogs/algorithm/dp/" class="nav-link">
  动态规划
</a></li><li class="dropdown-item"><!----> <a href="/blogs/algorithm/leetcode/" class="nav-link">
  leetcode
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs/backend/nginx/" class="nav-link">
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/blogs/backend/springboot/" class="nav-link">
  Springboot
</a></li><li class="dropdown-item"><!----> <a href="/blogs/backend/mybatis/" class="nav-link">
  mybatis
</a></li><li class="dropdown-item"><!----> <a href="/blogs/backend/uml/" class="nav-link">
  uml类图
</a></li><li class="dropdown-item"><!----> <a href="/blogs/backend/ddd/" class="nav-link">
  领域驱动设计
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="友链" class="dropdown-title"><span class="title">友链</span> <span class="arrow down"></span></button> <button type="button" aria-label="友链" class="mobile-dropdown-title"><span class="title">友链</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://lxchuan12.gitee.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  若川博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://www.inode.club/interview/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  程序员成长指北-node，面
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vue2.0基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blogs/vue/vue-basic.html" class="sidebar-link">VUE2.0基础</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vue2.0进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blogs/vue/vue-advance.html" class="sidebar-link">Vue2.0进阶</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vue-cli详解</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blogs/vue/vue-cli.html" class="sidebar-link">vue-cli详解</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vue-loader解析</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blogs/vue/vue-loader.html" class="sidebar-link">vue-loader解析</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vue-router详解</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blogs/vue/vue-router.html" class="sidebar-link">vue-router详解</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vuex</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blogs/vue/vuex.html" class="sidebar-link">vue-router详解</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vue-SSR</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blogs/vue/vue-ssr.html" class="sidebar-link">Vue-SSR</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vue-i18n</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blogs/vue/vue-i18n.html" class="sidebar-link">vue多语言i18n</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vue生命周期</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blogs/vue/vue-life.html" class="sidebar-link">vue生命周期</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>VUE框架原理</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blogs/vue/vue-reactive.html" class="sidebar-link">VUE框架原理</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue原理-diff算法</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blogs/vue/vue-diff.html" class="sidebar-link">Vue原理-diff算法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue编译原理</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blogs/vue/vue-compiler.html" class="sidebar-link">vue编译原理</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>vue实战总结</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blogs/vue/vue-refs.html" aria-current="page" class="active sidebar-link">vue实战总结</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blogs/vue/vue-refs.html#_1、开发技巧" class="sidebar-link">1、开发技巧</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blogs/vue/vue-refs.html#_1、attrs-和-inheritattrs" class="sidebar-link">1、attrs 和 inheritAttrs</a></li><li class="sidebar-sub-header"><a href="/blogs/vue/vue-refs.html#_2、异步事件问题" class="sidebar-link">2、异步事件问题</a></li></ul></li><li class="sidebar-sub-header"><a href="/blogs/vue/vue-refs.html#_2、性能优化" class="sidebar-link">2、性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blogs/vue/vue-refs.html#_1、fp-首屏加载优化" class="sidebar-link">1、FP 首屏加载优化</a></li><li class="sidebar-sub-header"><a href="/blogs/vue/vue-refs.html#_2、非响应式处理" class="sidebar-link">2、非响应式处理</a></li></ul></li><li class="sidebar-sub-header"><a href="/blogs/vue/vue-refs.html#_3、工程化实践" class="sidebar-link">3、工程化实践</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blogs/vue/vue-refs.html#_1、模块解耦" class="sidebar-link">1、模块解耦</a></li><li class="sidebar-sub-header"><a href="/blogs/vue/vue-refs.html#_2、mock-方案" class="sidebar-link">2、mock 方案</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue-实战总结"><a href="#vue-实战总结" class="header-anchor">#</a> vue 实战总结</h1> <h2 id="_1、开发技巧"><a href="#_1、开发技巧" class="header-anchor">#</a> 1、开发技巧</h2> <h3 id="_1、attrs-和-inheritattrs"><a href="#_1、attrs-和-inheritattrs" class="header-anchor">#</a> 1、attrs 和 inheritAttrs</h3> <p>通过 arrtrs 和 inheritAttrs 实现属性透传：</p> <ul><li>$props：props 声明的属性</li> <li>$attrs：非申明 props 的属性，用于组件封装属性透传，除 style 和 class 外，两者依然绑定在根组件上</li> <li>inheritAttrs：根元素不继承父元素设置的属性</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 子组件LinkButton <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;link-button&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>a <span class="token operator">:</span>href<span class="token operator">=</span><span class="token string">&quot;linkHref&quot;</span> v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;$attrs&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>slot<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>slot<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token comment">//知识点1：通过arrtrs和inheritAttrs实现属性透传：</span>
    <span class="token comment">//$props props声明的属性</span>
    <span class="token comment">//$attrs 非申声明props的属性，用于组件封装属性透传，除去style和class仍然绑定在根组件上</span>
    <span class="token literal-property property">inheritAttrs</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//根元素不继承父元素设置属性</span>
    <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">linkHref</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span>
            <span class="token literal-property property">require</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 父组件使用LinkButton <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 解析结果：设置inhertAttrs为<span class="token boolean">false</span>时，target、rel属性会透传至a元素上，<span class="token keyword">class</span>会作用在根元素上 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 最终结果：
<span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;button link-button&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;/&quot;</span> target<span class="token operator">=</span><span class="token string">&quot;_blank&quot;</span> rel<span class="token operator">=</span><span class="token string">&quot;nofollow noreferrer noopener&quot;</span><span class="token operator">&gt;</span>热点<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>link<span class="token operator">-</span>button linkHref<span class="token operator">=</span><span class="token string">&quot;/&quot;</span> target<span class="token operator">=</span><span class="token string">&quot;_blank&quot;</span> rel<span class="token operator">=</span><span class="token string">&quot;nofollow noreferrer noopener&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;button&quot;</span><span class="token operator">&gt;</span>热点<span class="token operator">&lt;</span><span class="token operator">/</span>link<span class="token operator">-</span>button<span class="token operator">&gt;</span>
</code></pre></div><p>解析：a 标签的属性 noopener, noreferrer 及 nofollow，<a href="https://zhuanlan.zhihu.com/p/366736912" target="_blank" rel="noopener noreferrer">参考资料：noopener 等使用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>a 标签通常搭配：noopener、noreferre、nofollow 属性使用，保证安全：</p> <ul><li><p>noopener：给链接加上 target=&quot;_blank&quot;后，目标网页会在新链接中打开，此时新网页可通过 window.opener 获取到源页面的 window 对象，存在安全隐患。eg：第三方页面可通过 window.opener.href = &quot;xxx&quot; 进行钓鱼。 设置后，第三方页面 window.opener=null</p></li> <li><p>noreferrer：与 noopener 类似，同时新开页面中还无法获取 document.referrer 信息， 该信息包含了来源页面的地址。通常 noopener 和 noreferrer 会同时设置， rel=&quot;noopener noreferrer&quot;。为了浏览器兼容，老的浏览器不支持 noopener</p></li> <li><p>nofollow 不要继续爬虫；搜索引擎对页面的权重计算中包含一项页面引用数 (backlinks),告诉搜索引擎， 本次链接不为上述排名作贡献</p></li></ul> <h3 id="_2、异步事件问题"><a href="#_2、异步事件问题" class="header-anchor">#</a> 2、异步事件问题</h3> <p>单值异步问题：点击按钮 1，再点击按钮 2，应该展示 2，因为 1 回调展示了按钮 1</p> <ul><li>方案一：数据结构变更</li> <li>方案二：提取异步函数，点击按钮 1，再点击 2 时，停止按钮 1 的事件，发起按钮 2 的事件</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">&quot;changeMsg(1, 2000)&quot;</span><span class="token operator">&gt;</span>按钮<span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">&quot;changeMsg(2)&quot;</span><span class="token operator">&gt;</span>按钮<span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function">changeMsg</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> time<span class="token operator">=</span><span class="token number">100</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> val
      <span class="token punctuation">}</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 方案一：数据结构转变 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">&quot;changeMsg(msg.btn1, 1, 2000)&quot;</span><span class="token operator">&gt;</span>按钮<span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">&quot;changeMsg(msg.btn2, 2)&quot;</span><span class="token operator">&gt;</span>按钮<span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
      <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">btn1</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        <span class="token literal-property property">btn2</span><span class="token operator">:</span> <span class="token string">''</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function">changeMsg</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> time<span class="token operator">=</span><span class="token number">100</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token operator">=</span>key
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        key <span class="token operator">=</span> value
      <span class="token punctuation">}</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 方案二：提取函数进行防抖处理 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function">changeMsg</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> time<span class="token operator">=</span><span class="token number">100</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timer<span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> val
      <span class="token punctuation">}</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h2 id="_2、性能优化"><a href="#_2、性能优化" class="header-anchor">#</a> 2、性能优化</h2> <h3 id="_1、fp-首屏加载优化"><a href="#_1、fp-首屏加载优化" class="header-anchor">#</a> 1、FP 首屏加载优化</h3> <h4 id="_1、减小-vendor-大小"><a href="#_1、减小-vendor-大小" class="header-anchor">#</a> 1、减小 vendor 大小</h4> <p>可使用大文件分析插件查看占用资源：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// npm install --save-dev webpack-bundle-analyzer</span>
<span class="token keyword">const</span> BundleAnalyzerPlugin <span class="token operator">=</span>
  <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack-bundle-analyzer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>BundleAnalyzerPlugin<span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">BundleAnalyzerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>cdn 加速（剥离外部引用）
引入工程中的所有 js、css 文件，编译时会打包进 vendor.js，vendor 太大加载时间较长，影响首屏体验。</li></ul> <p>解决方法：将外部 js、css 文件剥离，用资源的形式引用，浏览器可以使用多个异步线程将 vendor.js 、外部的 js 等进行价值，达到加速首开目的。外部文件可以使用 cdn 资源，或别的服务器资源。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1、vue.config.js配置</span>
<span class="token comment">//添加externals，忽略不需要打包的库</span>
<span class="token comment">//'vue-router':'VueRouter'解析：</span>
<span class="token comment">// 其中'vue-router'为引入的资源的名字，import vueRouter from 'vue-router'</span>
<span class="token comment">// 其中'VueRouter'为该模块提供给外部引用的名字，由对应的库自定，可在min.js中查看</span>
<span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">externals</span><span class="token operator">:</span><span class="token punctuation">{</span>
     <span class="token string-property property">'vue'</span><span class="token operator">:</span><span class="token string">'Vue'</span><span class="token punctuation">,</span>
     <span class="token string-property property">'vue-router'</span><span class="token operator">:</span><span class="token string">'VueRouter'</span><span class="token punctuation">,</span>
     <span class="token string-property property">'vuex'</span><span class="token operator">:</span><span class="token string">'Vuex'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//2、html引入静态资源</span>
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;//cdn.bootcss.com/vue-router/2.3.0/vue-router.min.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token comment">//3、去掉import引用</span>
<span class="token comment">//import Router from 'vue-router'</span>
<span class="token comment">//Vue.use(Router)</span>
</code></pre></div><ul><li>路由懒加载</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&quot;/list&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;List&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// route level code-splitting</span>
    <span class="token comment">// this generates a separate chunk (about.[hash].js) for this route</span>
    <span class="token comment">// which is lazy-loaded when the route is visited.</span>
    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: &quot;list&quot; */</span> <span class="token string">&quot;@/views/list/List.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>组件按需引用</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1、安装babel-plugin-component</span>
<span class="token comment">//npm install babel-plugin-component -D</span>

<span class="token comment">//2、修改babel配置：.babelrc、babel.config.js</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;es2015&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;modules&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;component&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;libraryName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;element-ui&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;styleLibraryName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;theme-chalk&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">//3、组件按需使用</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Button<span class="token punctuation">,</span> Select <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'element-ui'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span><span class="token punctuation">;</span>

Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>Button<span class="token punctuation">.</span>name<span class="token punctuation">,</span> Button<span class="token punctuation">)</span><span class="token punctuation">;</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>Select<span class="token punctuation">.</span>name<span class="token punctuation">,</span> Select<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/* 或写为
 * Vue.use(Button)
 * Vue.use(Select)
 */</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token parameter">h</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_2、服务器开启-gizp"><a href="#_2、服务器开启-gizp" class="header-anchor">#</a> 2、服务器开启 gizp</h4> <p>参考资料：<a href="https://www.cnblogs.com/zigood/p/12504401.html" target="_blank" rel="noopener noreferrer">Vue 项目 webpack 优化 compression-webpack-plugin 开启 gzip<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Gzip 是 Gun zip 的缩写，它将浏览器请求的文件先在服务器端进行压缩，然后传递给浏览器，浏览器解压之后再进行页面的解析工作。在服务端开启 Gzip 支持后，我们前端需要提供资源压缩包，对于的 gzip 包，浏览器如果支持 gzip，会自动查找有没有 gz 文件，找到了就加载 gz 然后本地解压执行。</p> <ul><li>使用 compression-webpack-plugin 插件，对每个 js 和 css 文件增加输出 gz 后缀的文件。</li> <li>配置服务器支持 gzip 包</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1、安装插件</span>
<span class="token comment">// npm install --save-dev compression-webpack-plugin</span>

<span class="token comment">//2、配置插件：生产环境，开启js\css压缩</span>
<span class="token keyword">const</span> CompressionPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'compression-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token function-variable function">chainWebpack</span><span class="token operator">:</span> <span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">'compressionPlugin'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CompressionPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(js|css)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token comment">// 匹配文件名</span>
      <span class="token literal-property property">threshold</span><span class="token operator">:</span> <span class="token number">10240</span><span class="token punctuation">,</span> <span class="token comment">// 对超过10k的数据压缩</span>
      <span class="token literal-property property">minRatio</span><span class="token operator">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span>
      <span class="token literal-property property">deleteOriginalAssets</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token comment">// 删除源文件</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//3、nginx服务器配置gzip支持</span>
gzip on<span class="token punctuation">;</span>
gzip_static on<span class="token punctuation">;</span>
gzip_min_length 1k<span class="token punctuation">;</span>
gzip_buffers <span class="token number">4</span> 32k<span class="token punctuation">;</span>
gzip_http_version <span class="token number">1.1</span><span class="token punctuation">;</span>
gzip_comp_level <span class="token number">2</span><span class="token punctuation">;</span>
gzip_types text<span class="token operator">/</span>plain application<span class="token operator">/</span>x<span class="token operator">-</span>javascript text<span class="token operator">/</span>css application<span class="token operator">/</span>xml<span class="token punctuation">;</span>
gzip_vary on<span class="token punctuation">;</span>
gzip_disable <span class="token string">&quot;MSIE [1-6].&quot;</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2、非响应式处理"><a href="#_2、非响应式处理" class="header-anchor">#</a> 2、非响应式处理</h3> <p>对于从始至终都未改变的死数据，比如写死的下拉框和表格数据，无需进行响应式处理，减少性能消耗。</p> <ul><li>将数据定义在 data 之外</li> <li>使用 object.freeze()</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>list1 <span class="token operator">=</span> <span class="token punctuation">{</span>xxx<span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>list2 <span class="token operator">=</span> <span class="token punctuation">{</span>xxx<span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    xxxx
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">list1</span><span class="token operator">:</span> Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span><span class="token punctuation">{</span>xxx<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token literal-property property">list2</span><span class="token operator">:</span> Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span><span class="token punctuation">{</span>xxx<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>解析：Object.freeze() 作用冻结一个对象， 返回和传入的参数相同的对象，一个被冻结的对象再也不能被修改</p> <ul><li>不能向这个对象添加新的属性，不能删除已有属性</li> <li>不能修改已有属性的值</li> <li>不能修改该对象已有属性的可枚举性、可配置性、可写性</li> <li>冻结一个对象后该对象的原型也不能被修改。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// vue不会对list里的object做getter、setter绑定</span>
    <span class="token literal-property property">list</span><span class="token operator">:</span> Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 界面不会有响应</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

    <span class="token comment">// 下面两种做法，界面都会响应</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>参考资料：<a href="https://juejin.cn/post/6844903922469961741" target="_blank" rel="noopener noreferrer">Vue 性能提升之 Object.freeze<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_3、工程化实践"><a href="#_3、工程化实践" class="header-anchor">#</a> 3、工程化实践</h2> <h3 id="_1、模块解耦"><a href="#_1、模块解耦" class="header-anchor">#</a> 1、模块解耦</h3> <p>将全局的 store、router、mock、i18n 公共文件离散化处理剥离在各业务模块内，提高模块的内聚程度，方便功能移植，实现模块解耦</p> <h4 id="_1、require-context"><a href="#_1、require-context" class="header-anchor">#</a> 1、require.context</h4> <p>使用 webpack 的 api 实现代码自动导入，初始化时自动解析导入，实现 route、store 等解耦拆分</p> <p>require.context 在 webpack 解析打包时自动执行。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//入参解析</span>
require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span>
  directory<span class="token punctuation">,</span> <span class="token comment">//读取文件的路径</span>
  <span class="token punctuation">(</span>useSubdirectories <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//是否遍历文件的子目录</span>
  <span class="token punctuation">(</span>regExp <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\.\/.*$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//要匹配文件的正则</span>
  <span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">&quot;sync&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//输出解析</span>
<span class="token comment">/* 
1、输出为函数 webpackContext(req)
1.1、webpackContext函数，入参为路径，出参为模块，可取出defalut模块
1.2、函数也是对象，可有属性
2、输出的函数有三个属性，keys、id、resolve
2.1、resolve{Function} -接受一个参数request,request为test文件夹下面匹配文件的相对路径,返回这个匹配文件相对于整个工程的相对路径
2.2、keys {Function} -返回匹配成功模块的名字组成的数组
2.3、id {String} -执行环境的id,返回的是一个字符串,主要用在module.hot.accept
*/</span>

<span class="token comment">//示例：index.js  ./modules/home.js</span>
<span class="token keyword">const</span> modulesFiles <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">&quot;./modules&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>modulesFiles<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
ƒ webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
*/</span>

console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>modulesFiles<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
ƒ webpackContext(req)
id: &quot;./src/store/modules sync recursive \\.js$&quot;
keys: ƒ webpackContextKeys()
resolve: ƒ webpackContextResolve(req)
*/</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>modulesFiles<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//[&quot;./home.js&quot;]</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>modulesFiles<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//./src/store/modules sync recursive \.js$</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>modulesFiles<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;./home.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//./src/store/modules/home.js</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">modulesFiles</span><span class="token punctuation">(</span><span class="token string">&quot;./home.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
Module
default: {namespaced: true, state: {…}, getters: {…}, mutations: {…}}
*/</span>
</code></pre></div><ul><li>store 解耦合</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">&quot;vuex&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> actions <span class="token keyword">from</span> <span class="token string">&quot;./actions.js&quot;</span>
<span class="token keyword">import</span> state <span class="token keyword">from</span> <span class="token string">&quot;./state.js&quot;</span>
<span class="token keyword">import</span> mutations <span class="token keyword">from</span> <span class="token string">&quot;./mutations.js&quot;</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> store <span class="token operator">=</span> <span class="token punctuation">{</span>
  state<span class="token punctuation">,</span>
  actions<span class="token punctuation">,</span>
  mutations
<span class="token punctuation">}</span>
<span class="token keyword">const</span> modulesFiles <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'./modules'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span>
<span class="token keyword">const</span> modules <span class="token operator">=</span> modulesFiles<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">modules<span class="token punctuation">,</span> modulePath</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  		<span class="token comment">//['./home.js']  ./home.js -&gt; home</span>
      <span class="token keyword">const</span> moduleName <span class="token operator">=</span> modulePath<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\.\/(.*)\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">'$1'</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> module <span class="token operator">=</span> <span class="token function">modulesFiles</span><span class="token punctuation">(</span>modulePath<span class="token punctuation">)</span><span class="token punctuation">.</span>default
      modules<span class="token punctuation">[</span>moduleName<span class="token punctuation">]</span> <span class="token operator">=</span> module
      <span class="token keyword">return</span> modules
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
store <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">...</span>store<span class="token punctuation">,</span> modules<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
array.reduce(function(total, currentValue, currentIndex, arr), initialValue)
1、total 必需，初始值, 或者计算结束后的返回值
2、currentValue	必需，当前元素
3、currentIndex	可选，当前元素的索引
4、arr	可选，当前元素所属的数组对象
5、initialValue 可选，传递给函数的初始值
*/</span>

</code></pre></div><h4 id="_2、使用-register-方法"><a href="#_2、使用-register-方法" class="header-anchor">#</a> 2、使用 register 方法</h4> <p>重写 vue 类，子组件使用重写类，重写 beforeCreate 和 destoryed 方法，store、i18n、router 通过参数传入后在 beforeCreate 注入，在 destoryed 中销毁，实现模块的解耦。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//方法调用</span>
<span class="token comment">/**
 * 功能：vuee重写vue，注入store、i18n
 * 输入：vuee(option, fieldMap, state)
 * vuee({
 *    data:{
 *    }
 * },
 * {
 *  state: {
 *     'self': ['a', 'b'],
 *     'global': ['c']
 *  },
 *  mutations: {
 *  },
 *  getters: {
 *  },
 *  actions: {
 *  },
 *  {
 *    mName: 'role',
 *    store,
 *    i18nEN,
 *    i18nZH
 *  }
 * }
 *
  * )
 */</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>mapState<span class="token punctuation">,</span> mapActions<span class="token punctuation">,</span> mapMutations<span class="token punctuation">,</span> mapGetters<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex'</span>

<span class="token comment">//propsData: 创建实例时传入的props</span>
<span class="token keyword">const</span> <span class="token function-variable function">getNamespaceProp</span> <span class="token operator">=</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">!</span>data <span class="token operator">||</span> <span class="token operator">!</span>data<span class="token punctuation">.</span>propsData<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">''</span> <span class="token operator">:</span> data<span class="token punctuation">.</span>propsData<span class="token punctuation">.</span>namespace
<span class="token punctuation">}</span>
<span class="token comment">/**
 * store数据的通用map方法
 * @param {*} mName 视图的store模块名称
 * @param {*} mapData 需要映射的字段map
 * @param {*} type 映射的类型，包括state、action、getter和mutation
 * eg: mapExt(name, fieldMap.state, 'state')
 * fieldMap.state三种入参
 * ['a', 'b', 'c']
 * {
 *  state: {
 *     'self': ['a', 'b'],
 *     'global': ['c']
 *  }
 * }
 * {
 *  state: {
 *    'getTime': 'time'
 *  }
 * }
 */</span>
<span class="token keyword">const</span> mapExt <span class="token operator">=</span> <span class="token punctuation">(</span>mName<span class="token punctuation">,</span> mapData<span class="token punctuation">,</span> type<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>mapData<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">let</span> methodMap <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">state</span><span class="token operator">:</span> mapState<span class="token punctuation">,</span>
        <span class="token literal-property property">action</span><span class="token operator">:</span> mapActions<span class="token punctuation">,</span>
        <span class="token literal-property property">mutation</span><span class="token operator">:</span> mapMutations<span class="token punctuation">,</span>
        <span class="token literal-property property">getter</span><span class="token operator">:</span> mapGetters
    <span class="token punctuation">}</span>
     <span class="token keyword">if</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>mapData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//mapActions('moduleA', ['getInfo', 'getTime']) //子模块</span>
        <span class="token comment">//mapGetters(['getInfo', 'getTime'])  全局</span>
        <span class="token keyword">return</span> mName <span class="token operator">?</span> methodMap<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span>mName<span class="token punctuation">,</span> mapData<span class="token punctuation">)</span> <span class="token operator">:</span> methodMap<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span>mapData<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> mapData <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> simpleImport <span class="token operator">=</span> <span class="token boolean">false</span>
        <span class="token keyword">let</span> ret <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>mapData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> mapData<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                simpleImport <span class="token operator">=</span> <span class="token boolean">true</span>
                <span class="token keyword">break</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'global'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    ret <span class="token operator">=</span> <span class="token punctuation">{</span>
                        <span class="token operator">...</span>ret<span class="token punctuation">,</span>
                        <span class="token operator">...</span>methodMap<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span>mapData<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">root</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                    ret <span class="token operator">=</span> <span class="token punctuation">{</span>
                        <span class="token operator">...</span>ret<span class="token punctuation">,</span>
                        <span class="token operator">...</span>methodMap<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'self'</span><span class="token operator">?</span> mName <span class="token operator">:</span> key<span class="token punctuation">,</span> mapData<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>          <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>simpleImport<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> mName <span class="token operator">?</span> methodMap<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span>mName<span class="token punctuation">,</span> mapData<span class="token punctuation">)</span> <span class="token operator">:</span> methodMap<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span>mapData<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> ret
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">vuee</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> fieldMap<span class="token punctuation">,</span> state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> comInstance <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>options <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token punctuation">{</span>mName<span class="token punctuation">,</span> store<span class="token punctuation">,</span> i18nEN<span class="token punctuation">,</span> i18nZH<span class="token punctuation">}</span> <span class="token operator">=</span> state
        <span class="token keyword">let</span> <span class="token punctuation">{</span>beforeCreate<span class="token punctuation">,</span> destroyed<span class="token punctuation">}</span> <span class="token operator">=</span> options
        <span class="token keyword">let</span> ns <span class="token operator">=</span> mName <span class="token operator">||</span> <span class="token function">getNamespaceProp</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">)</span>
        <span class="token comment">//namespace属性为true，namespace为ns/，否则为ns</span>
        <span class="token keyword">let</span> namespace <span class="token operator">=</span> store<span class="token punctuation">.</span>namespace <span class="token operator">?</span> ns <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">:</span> ns
        <span class="token keyword">let</span> module <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>_modulesNamespaceMap<span class="token punctuation">[</span>namespace<span class="token punctuation">]</span>
          <span class="token comment">//重写beforeCreate</span>
        comInstance<span class="token punctuation">.</span><span class="token function-variable function">beforeCreate</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">//新旧页面切换时，存在引入公用模块相同，新页面会丢失公用模块的数据状态，旧页面destoryed过程会发生在新页面beforeCreate之后</span>
      <span class="token comment">//通过给模块设置覆盖标记解决，只有模块状态未被覆盖时才允许卸载模块绑定数据</span>
                module<span class="token punctuation">.</span>$$overide <span class="token operator">=</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">registerModule</span><span class="token punctuation">(</span>ns<span class="token punctuation">,</span> store<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>

            <span class="token comment">//i18扩展</span>
            <span class="token keyword">let</span> message <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$i18n<span class="token punctuation">.</span>message
            message<span class="token punctuation">.</span>en <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">...</span>message<span class="token punctuation">.</span>en<span class="token punctuation">,</span> <span class="token operator">...</span>i18nEN<span class="token punctuation">}</span>
            message<span class="token punctuation">.</span>zh <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">...</span>message<span class="token punctuation">.</span>en<span class="token punctuation">,</span> <span class="token operator">...</span>i18nZH<span class="token punctuation">}</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$i18n<span class="token punctuation">.</span>message <span class="token operator">=</span> message

            beforeCreate <span class="token operator">&amp;&amp;</span> <span class="token function">beforeCreate</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
          <span class="token comment">//重写destoryed</span>
        comInstance<span class="token punctuation">.</span><span class="token function-variable function">destroyed</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>$$overide<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    module<span class="token punctuation">.</span>$$overide <span class="token operator">=</span> <span class="token boolean">false</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">unregisterModule</span><span class="token punctuation">(</span>ns<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">unregisterModule</span><span class="token punctuation">(</span>ns<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            destroyed <span class="token operator">&amp;&amp;</span> <span class="token function">destroyed</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>fieldMap<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> name <span class="token operator">=</span> state <span class="token operator">?</span> mName <span class="token operator">:</span> <span class="token keyword">null</span>
        comInstance<span class="token punctuation">.</span>computed <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token operator">...</span><span class="token function">mapExt</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> fieldMap<span class="token punctuation">.</span>state<span class="token punctuation">,</span> <span class="token string">'state'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token operator">...</span><span class="token function">mapExt</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> fieldMap<span class="token punctuation">.</span>getter<span class="token punctuation">,</span> <span class="token string">'getter'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token operator">...</span>options<span class="token punctuation">.</span>computed
        <span class="token punctuation">}</span>
        comInstance<span class="token punctuation">.</span>methods <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token operator">...</span><span class="token function">mapExt</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> fieldMap<span class="token punctuation">.</span>mutations<span class="token punctuation">,</span> <span class="token string">'mutation'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token operator">...</span><span class="token function">mapExt</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> fieldMap<span class="token punctuation">.</span>actions<span class="token punctuation">,</span> <span class="token string">'action'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token operator">...</span>options<span class="token punctuation">.</span>methods
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    options <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">//释放空间</span>
    <span class="token keyword">return</span> comInstance
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> vue<span class="token punctuation">;</span>
</code></pre></div><h4 id="_3、插件化机制"><a href="#_3、插件化机制" class="header-anchor">#</a> 3、插件化机制</h4> <p>将公用组件及模块配置成插件包，可通过动态安装插件实现功能扩展，参照 umi 结构</p> <ul><li>使用自动注册插件自动安装相关插件包或手动引入</li> <li>子定义插件
<ul><li>npm 包形式
<ul><li>创建插件包，以@plugin 开头，eg：@plugin/demo</li> <li>插件开发目录包含 src 目录，放置 es6 编写的 index.js 文件</li> <li>插件开发目录建立 lib 目录，放置 babel 编译过的 index.js 文件</li></ul></li> <li>本地方式：src/utils/plugin 内新增插件</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//插件接口：xPlugin.init(Vue, router, store, settings)</span>
<span class="token comment">//一、使用：main.js</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'Vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./store'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> settings <span class="token keyword">from</span> <span class="token string">'./settings'</span><span class="token punctuation">;</span>

<span class="token comment">//1、手动导入</span>
<span class="token keyword">import</span> xPlugin <span class="token keyword">from</span> <span class="token string">'@plugin/xPlugin'</span><span class="token punctuation">;</span>
xPlugin<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//2、自动导入：直接使用registerPlugin即可</span>
<span class="token keyword">import</span> registerPlugin <span class="token keyword">from</span> <span class="token string">'@plugin/register'</span><span class="token punctuation">;</span>
<span class="token function">registerPlugin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//会自动引入所有插件</span>

<span class="token comment">//二、插件结构：xPlugin</span>
<span class="token keyword">class</span> <span class="token class-name">xPlugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter">Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">router</span><span class="token punctuation">(</span>router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">store</span><span class="token punctuation">(</span>store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token function">router</span><span class="token punctuation">(</span><span class="token parameter">router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token operator">...</span>
  <span class="token punctuation">}</span>
   <span class="token keyword">static</span> <span class="token function">store</span><span class="token punctuation">(</span><span class="token parameter">store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token operator">...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> xPlugin<span class="token punctuation">;</span>
</code></pre></div><h5 id="_1、自动注入插件"><a href="#_1、自动注入插件" class="header-anchor">#</a> 1、自动注入插件</h5> <ul><li>注册 npm 包插件：读取@plugin 域下面的插件，并调用插件的 init()方法执行，完成注册</li> <li>注册本地插件，执行插件的 init()方法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/* 目录结构
-@plugin
	-register
	  -lib
	  -src
	  .babelrc
	  package.json
*/</span>

<span class="token comment">//.babelrc</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;es2015&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">//.package.json</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;main&quot;</span><span class="token operator">:</span><span class="token string">&quot;/lib/index.js&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;babel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;babel -d lib/ src/&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;devDependencies&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;babel&quot;</span><span class="token operator">:</span><span class="token string">&quot;^6.x.x&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;babel-cli&quot;</span><span class="token operator">:</span><span class="token string">&quot;^6.x.x&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;babel-preset-es2015&quot;</span><span class="token operator">:</span><span class="token string">&quot;^6.x.x&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// src/index.js</span>
<span class="token keyword">const</span> <span class="token function-variable function">registerPlugin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> modulesFiles <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'@plugin'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">index.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//注册npm包插件</span>
  modulesFiles<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">modules<span class="token punctuation">,</span> modulePath</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>modulePath <span class="token operator">!==</span> <span class="token string">'./register/index.js'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      	<span class="token keyword">const</span> plugin <span class="token operator">=</span> <span class="token function">modulesFiles</span><span class="token punctuation">(</span>modulePath<span class="token punctuation">)</span>
        plugin<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//注册本地插件</span>
  <span class="token keyword">try</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> utilFiles <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'@/utils/plugin'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  	utilFiles<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">modules<span class="token punctuation">,</span> modulePath</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      	<span class="token keyword">const</span> plugin <span class="token operator">=</span> <span class="token function">utilFiles</span><span class="token punctuation">(</span>modulePath<span class="token punctuation">)</span>
        plugin<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span>
  	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>code <span class="token operator">!==</span> <span class="token string">&quot;MODULE_NOT_FOUND&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> registerPlugin<span class="token punctuation">;</span>

</code></pre></div><h5 id="_2、iframe-插件"><a href="#_2、iframe-插件" class="header-anchor">#</a> 2、iframe 插件</h5> <ul><li>缓存用 iframe 标签加载的页面，避免切换路由时重复加载浪费性能</li> <li>可以使用传参来决定是否刷新当前页面，若不刷新，会缓存上一次组件实例，不毁摧毁</li> <li>原理
<ul><li>在布局时新建一个 id 为 iframe-root 的 Dom 节点，此节点与右侧内容区是兄弟节点</li> <li>把访问过的每一个 iframe 页面都当成一个子节点 appendChild 到 iframe-root 上</li> <li>切换路由时控制 iframe 页面节点的 display 属性为 block 或者 none</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1、安装插件：npm install @plugin/iframe</span>

<span class="token comment">//2、注册插件：main.js</span>
<span class="token keyword">import</span> IframePlugin <span class="token keyword">from</span> <span class="token string">'@plugin/iframe'</span>
IframePlugin<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//3、使用插件</span>
<span class="token comment">//3.1、添加iframe-root的dom节点: main.vue</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 内包含：router<span class="token operator">-</span>view元素 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>main<span class="token operator">-</span>app id<span class="token operator">=</span><span class="token string">&quot;main-app&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>main<span class="token operator">-</span>app<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;iframe-root&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token comment">//3.2、配置参数: setting.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">iframeRoot</span><span class="token operator">:</span> <span class="token string">&quot;iframe-root&quot;</span><span class="token punctuation">,</span> 						<span class="token comment">//iframe容器标签id，用于append元素</span>
  <span class="token literal-property property">iframeComponent</span><span class="token operator">:</span> <span class="token string">&quot;iframeComponent&quot;</span><span class="token punctuation">,</span>		<span class="token comment">//iframe模块路由前缀</span>
  <span class="token literal-property property">routerView</span><span class="token operator">:</span> <span class="token string">&quot;main-app&quot;</span><span class="token punctuation">,</span>               <span class="token comment">//路由页面出口dom的id</span>
<span class="token punctuation">}</span>

<span class="token comment">//3.3、组件中调用setIframeUrl方法</span>
<span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token function">showIframe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'iframe/setIframeUrl'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'http://www.xxx.com'</span><span class="token punctuation">,</span>           <span class="token comment">//iframe地址</span>
      <span class="token literal-property property">refresh</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>                      <span class="token comment">//是否刷新</span>
      <span class="token literal-property property">oUrl</span><span class="token operator">:</span> <span class="token string">'/ifremeComponent/iframePage'</span>  <span class="token comment">//当前路由</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//4、插件细节，结构同上，src/index.js</span>
<span class="token keyword">class</span> <span class="token class-name">IframePlugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter">Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">router</span><span class="token punctuation">(</span>router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">store</span><span class="token punctuation">(</span>store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token function">router</span><span class="token punctuation">(</span><span class="token parameter">router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//router-view和iframe容器相互切换展示</span>
    <span class="token comment">//命中iframe的路由则展示iframe容器，router-view隐藏</span>
    router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">const</span> isIframe <span class="token operator">=</span> to<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>iframeComponent<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>from<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>iframeComponent<span class="token punctuation">)</span> <span class="token operator">!==</span> isIframe<span class="token punctuation">)</span><span class="token punctuation">{</span>
        store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'iframe/switchDisplay'</span><span class="token punctuation">,</span> isIframe<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token function">store</span><span class="token punctuation">(</span><span class="token parameter">store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">iframeSet</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> mutations <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">addIframe</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> newIframe</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> iframeDom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'iframe'</span><span class="token punctuation">)</span>
        iframeDom<span class="token punctuation">.</span>src <span class="token operator">=</span> newIframe<span class="token punctuation">.</span>url
        iframeDom<span class="token punctuation">.</span>oUrl <span class="token operator">=</span> newIframe<span class="token punctuation">.</span>oUrl
        iframeDom<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'iframe'</span>
        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>iframeRoot<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>iframeDom<span class="token punctuation">)</span>
        state<span class="token punctuation">.</span>iframeSet<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">path</span><span class="token operator">:</span> newIframe<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
          <span class="token literal-property property">oUrl</span><span class="token operator">:</span> newIframe<span class="token punctuation">.</span>oUrl
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">deleteSingleIframe</span><span class="token operator">:</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> view<span class="token punctuation">)</span><span class="token punctuation">{</span>
      	<span class="token keyword">const</span> iframes <span class="token operator">=</span> document
      				<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>iframeRoot<span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">getElementByTagName</span><span class="token punctuation">(</span><span class="token string">'iframe'</span><span class="token punctuation">)</span>
    		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>iframes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//remove dom</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>iframes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>oUrl <span class="token operator">===</span> view<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">{</span>
            iframes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>iframes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>i<span class="token punctuation">,</span> v<span class="token punctuation">]</span> <span class="token keyword">of</span> state<span class="token punctuation">.</span>iframeSet<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>oUrl <span class="token operator">===</span> view<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">{</span>
            state<span class="token punctuation">.</span>iframeSet<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    	<span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">switchIframe</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> newIframe</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> iframes <span class="token operator">=</span> document
      				<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>iframeRoot<span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">getElementByTagName</span><span class="token punctuation">(</span><span class="token string">'iframe'</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span> iframes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>iframes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>oUrl <span class="token operator">===</span> newIframe<span class="token punctuation">.</span>oUrl<span class="token punctuation">)</span><span class="token punctuation">{</span>
            iframes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'block'</span>
          <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            iframes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">switchDisplay</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> isIFrame</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token function-variable function">display</span> <span class="token operator">=</span> <span class="token parameter">bool</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>bool <span class="token operator">?</span> <span class="token string">'block'</span> <span class="token operator">:</span> <span class="token string">'none'</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> iframeRoot <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>iframeRoot<span class="token punctuation">)</span>
        <span class="token keyword">const</span> routerView <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>routerView<span class="token punctuation">)</span>
        iframeRoot <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>iframeRoot<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token function">display</span><span class="token punctuation">(</span>isIframe<span class="token punctuation">)</span><span class="token punctuation">)</span>
        routerView <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>routerView<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token operator">!</span>isIframe<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> actions <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token function">setIframeUrl</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>commit<span class="token punctuation">,</span> state<span class="token punctuation">}</span><span class="token punctuation">,</span> iframe</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//some监测数组中是否有元素符合条件</span>
        <span class="token keyword">const</span> hasIframeUrl <span class="token operator">=</span> state<span class="token punctuation">.</span>iframeSet<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">el</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> el<span class="token punctuation">.</span>oUrl <span class="token operator">===</span> iframe<span class="token punctuation">.</span>oUrl
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>hasIframeUrl<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//not exist</span>
          <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'addIframe'</span><span class="token punctuation">,</span> iframe<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>iframe<span class="token punctuation">.</span>refresh<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//exist, refresh needed</span>
          <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'deleteSingleIframe'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">path</span><span class="token operator">:</span> iframe<span class="token punctuation">.</span>oUrl<span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'addIframe'</span><span class="token punctuation">,</span> iframe<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'switchIframe'</span><span class="token punctuation">,</span> iframe<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    store<span class="token punctuation">.</span><span class="token function">registerModule</span><span class="token punctuation">(</span><span class="token string">'iframe'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">namespaced</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      state<span class="token punctuation">,</span>
      mutations<span class="token punctuation">,</span>
      actions
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> IframePlugin<span class="token punctuation">;</span>
</code></pre></div><h5 id="_3、微前端插件"><a href="#_3、微前端插件" class="header-anchor">#</a> 3、微前端插件</h5> <ul><li>原理
<ul><li>主应用初始化会加载配置文件解析得到所有子应用文件所在的节点列表</li> <li>进行功能切换时，主应用根据要跳转的路由在上述节点清单上找到对应子应用的节点入口并加载子应用静态文件，通过解析子应用静态文件通过调用 Vuex 等插件的 api 将子应用的信息注册至主应用中的 vue 实例上</li> <li>子应用信息注册完成后，主应用会加载对应组件并跳转至相应页面</li></ul></li> <li>主应用
<ul><li>使用微前端插件，将加载的子工程的静态资源地址赋值给 script 标签的 src 属性并 append 到 html 的 body 上</li> <li>将主工程的状态、路由、多语言文件挂接至 Vue.prototype 供子应用使用</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1、安装插件：npm install @plugin/microfrontendLoad</span>

<span class="token comment">// 2、配置及加载插件：main.js、settings.js、microFrontEndConfig.js</span>
<span class="token comment">// 2.1、main.js</span>
<span class="token keyword">import</span> microfrontendLoad <span class="token keyword">from</span> <span class="token string">&quot;@plugin/microfrontendLoad&quot;</span><span class="token punctuation">;</span>
microfrontendLoad<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 2.2、settings.js</span>
<span class="token keyword">import</span> i18n <span class="token keyword">from</span> <span class="token string">&quot;@/lang&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> request <span class="token keyword">from</span> <span class="token string">&quot;./utils/request&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Message <span class="token keyword">from</span> <span class="token string">&quot;element-ui/packages/message/src/main&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">MICROAPPCONFIG</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./microFrontEndConfig&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">microfrontentConfig</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">i18n</span><span class="token operator">:</span> i18n<span class="token punctuation">,</span>
    <span class="token literal-property property">request</span><span class="token operator">:</span> request<span class="token punctuation">,</span>
    <span class="token constant">MICRO_APP_CONFIG</span><span class="token operator">:</span> <span class="token constant">MICROAPPCONFIG</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 2.3、microFrontEndConfig.js</span>
window<span class="token punctuation">.</span>_baseUrl <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">MICROAPPCONFIG</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">devMenu</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;childA&quot;</span><span class="token punctuation">,</span> <span class="token comment">//子应用唯一标识，用于避免重复加载资源</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;childA&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&quot;/childA&quot;</span><span class="token punctuation">,</span> <span class="token comment">//子应用路由前缀</span>
      <span class="token literal-property property">urlPath</span><span class="token operator">:</span> <span class="token string">&quot;/app.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">//子应用入口文件</span>
      <span class="token literal-property property">origin</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8081&quot;</span><span class="token punctuation">,</span>
      <span class="token comment">//子应用静态资源所在路径，通常配合nginx反向代理使用，使整体项目处于同一域名</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//开发环境</span>
  <span class="token literal-property property">normalMenu</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;childA&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;childA&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&quot;/childA&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">urlPath</span><span class="token operator">:</span> <span class="token string">&quot;/app.js&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">origin</span><span class="token operator">:</span> window<span class="token punctuation">.</span>_baseUrl <span class="token operator">+</span> <span class="token string">&quot;/childA/js&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//生产环境，同上</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> <span class="token constant">MICROAPPCONFIG</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 3、插件结构同上，/src/index.js</span>
<span class="token keyword">function</span> <span class="token function">appendScript</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;script&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  script<span class="token punctuation">.</span>src <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">&quot;?t=&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  script<span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">microFrontendLoad</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter">Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span>Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadChild</span><span class="token punctuation">(</span>Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
    config<span class="token punctuation">.</span><span class="token function">loadAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//挂载至全局供子应用使用</span>
  <span class="token keyword">static</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token parameter">Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> i18n<span class="token punctuation">,</span> request <span class="token punctuation">}</span> <span class="token operator">=</span> settings<span class="token punctuation">.</span>microfrontendConfig<span class="token punctuation">;</span>
    <span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_router <span class="token operator">=</span> router<span class="token punctuation">;</span>
    <span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_store <span class="token operator">=</span> store<span class="token punctuation">;</span>
    <span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_i18n <span class="token operator">=</span> i18n<span class="token punctuation">;</span>
    <span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$request <span class="token operator">=</span> request<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token function">loadChild</span><span class="token punctuation">(</span><span class="token parameter">Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">MICRO_APP_CONFIG</span> <span class="token punctuation">}</span> <span class="token operator">=</span> settings<span class="token punctuation">.</span>microfrontendConfig<span class="token punctuation">;</span>
    <span class="token keyword">const</span> online <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;producting&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> devMenu <span class="token operator">=</span> <span class="token constant">MICRO_APP_CONFIG</span><span class="token punctuation">.</span>devMenu<span class="token punctuation">;</span>
    <span class="token keyword">const</span> normalMenu <span class="token operator">=</span> <span class="token constant">MICRO_APP_CONFIG</span><span class="token punctuation">.</span>normalMenu<span class="token punctuation">;</span>
    <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">menu</span><span class="token operator">:</span> online <span class="token operator">?</span> normalMenu <span class="token operator">:</span> devMenu<span class="token punctuation">,</span>
      <span class="token literal-property property">current</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">loadQueen</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">load</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>current</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        item <span class="token operator">=</span> item <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>menu<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;当前path，未匹配到路由菜单&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>current <span class="token operator">=</span> item<span class="token punctuation">;</span>
        <span class="token comment">//在主项目或非当前子项目 启动时才需要动态加载</span>
        <span class="token keyword">const</span> isCurrentProject <span class="token operator">=</span> location<span class="token punctuation">.</span>origin <span class="token operator">===</span> item<span class="token punctuation">.</span>origin<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>isCurrentProject<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>loadQueen<span class="token punctuation">[</span>item<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>loadQueen<span class="token punctuation">[</span>item<span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
          <span class="token function">appendScript</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>id<span class="token punctuation">,</span> item<span class="token punctuation">.</span>origin <span class="token operator">+</span> item<span class="token punctuation">.</span>urlPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">loadAll</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>menu<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> thi<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">getCurrent</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>menu<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>path <span class="token operator">===</span> location<span class="token punctuation">.</span>hash<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>current<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">addWatch</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> item <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>menu<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> to<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>path<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">//当访问路径属于某个子工程并且未加载时</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>item <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>loadQueen<span class="token punctuation">[</span>item<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>matched<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;该功能正在加载或暂不可用，请稍后再试&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">next</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    config<span class="token punctuation">.</span><span class="token function">getCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;DOMContentLoaded&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      config<span class="token punctuation">.</span><span class="token function">addWatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> config<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> microFrontendLoad<span class="token punctuation">;</span>
</code></pre></div><ul><li>子应用：通过 Vue.prototype 注册信息，包括状态、多语言、路由</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_router<span class="token punctuation">.</span><span class="token function">addRoutes</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_store<span class="token punctuation">.</span><span class="token function">registerModule</span><span class="token punctuation">(</span>appName<span class="token punctuation">,</span> module<span class="token punctuation">)</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_i18n<span class="token punctuation">.</span><span class="token function">mergeLocaleMessage</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> lang<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>应用间通讯
<ul><li>单页面应用只有一个 Vue 实例，所以应用间通讯依赖 Vue 的原型</li> <li>对于主应用和子应用，运行时共享页面的 location、window、localStorage 等全局对象，可通过这些来实现</li></ul></li></ul> <h3 id="_2、mock-方案"><a href="#_2、mock-方案" class="header-anchor">#</a> 2、mock 方案</h3> <p>参考资料 1：<a href="https://www.cnblogs.com/l-y-h/archive/2019/10/17/11691110.html" target="_blank" rel="noopener noreferrer">vue 中 mock 使用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
参考资料 2：<a href="https://www.cnblogs.com/l-y-h/p/12955001.html#_label2" target="_blank" rel="noopener noreferrer">axios 和 mock 封装使用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="_1、mock-js"><a href="#_1、mock-js" class="header-anchor">#</a> 1、mock.js</h4> <p>开发环境使用 mock.js 库，对请求进行拦截，无实际请求内容。</p> <div class="language-js extra-class"><pre class="language-js"><code>Mock<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span> rurl<span class="token operator">?</span><span class="token punctuation">,</span> rtype<span class="token operator">?</span><span class="token punctuation">,</span> template <span class="token punctuation">)</span> <span class="token punctuation">)</span>
Mock<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span> rurl<span class="token punctuation">,</span> rtype<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">options</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>

<span class="token comment">/* 参数解析
1、rurl 可选
表示要拦截的url，可以使字符串，也可以是正则

2、rtype 可选
表示要拦截的ajax请求方式，如get、post

3、template 可选
数据模板，可以是对象也可以是字符串

4、function(option) 可选
表示用于生成响应数据的函数
*/</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//main.js</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../mock/mock.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//mock.js</span>
<span class="token keyword">import</span> Mock <span class="token keyword">from</span> <span class="token string">&quot;mockjs&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> mocks <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">&quot;@/views&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.+\/mock\/.*\.js</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mocks<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">mockPath</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> mock <span class="token operator">=</span> <span class="token function">mocks</span><span class="token punctuation">(</span>mockPath<span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>
  Mock<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span>mock<span class="token punctuation">.</span>url<span class="token punctuation">,</span> mock<span class="token punctuation">.</span>method<span class="token punctuation">,</span> mock<span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// @/views/../mock/index.js</span>
<span class="token keyword">const</span> listData <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">date</span><span class="token operator">:</span> <span class="token string">&quot;2016-05-02&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;王小虎&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">&quot;上海市普陀区金沙江路 1518 弄&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">date</span><span class="token operator">:</span> <span class="token string">&quot;2016-05-04&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;王小虎&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">&quot;上海市普陀区金沙江路 1517 弄&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">date</span><span class="token operator">:</span> <span class="token string">&quot;2016-05-01&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;王小虎&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">&quot;上海市普陀区金沙江路 1519 弄&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">date</span><span class="token operator">:</span> <span class="token string">&quot;2016-05-03&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;王小虎&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">&quot;上海市普陀区金沙江路 1516 弄号&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;/user/info&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">result</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">info</span><span class="token operator">:</span> listData<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_2、后端-mock"><a href="#_2、后端-mock" class="header-anchor">#</a> 2、后端 mock</h4> <ul><li>可对接第三方 mock 服务</li> <li>使用 devserver 的 before 进行数据 mock：before 和 after 配置用于在 webpack-dev-server 定义额外的中间件
<ul><li>before 在 webpack-dev-server 静态资源中间件处理之前，可以用于拦截部分请求返回特定内容，或者实现简单的数据 mock</li> <li>after 在 webpack-dev-server 静态资源中间件处理之后，比较少用到，可以用于打印日志或者做一些额外处理</li> <li>before 和 after 参数：function (app, server, compiler)</li></ul></li></ul> <p>思路：</p> <ol><li>webpack-dev-server 本质是一个 express 服务器，使用原生 before 勾子注册路径实现数据 mock，使用 chokidar 进行数据检测实现热更新加载。</li> <li>before 勾子中使用 webpack-api-mocker 中间件实现数据 mock 和热更新。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
apiMocker(app, mockerFilePath[, options])
apiMocker(app, Mocker[, options])
*/</span>

<span class="token comment">//vue.config.js</span>
<span class="token function-variable function">before</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">app</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">apiMocker</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;./mock/mock-server.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//mock-server.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string-property property">&quot;GET /api/login&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">success</span><span class="token operator">:</span> appData<span class="token punctuation">.</span>login<span class="token punctuation">.</span>success<span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> appData<span class="token punctuation">.</span>login<span class="token punctuation">.</span>message<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;GET /api/list&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">&quot;kenny&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">&quot;kenny&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;POST /api/post&quot;</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">403</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;DELETE /api/remove&quot;</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token string">&quot;ok&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&quot;删除成功！&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新时间:</span> <span class="time">3/27/2023, 9:16:44 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blogs/vue/vue-compiler.html" class="prev">
        vue编译原理
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blogs/assets/js/app.318ed052.js" defer></script><script src="/blogs/assets/js/2.b253f094.js" defer></script><script src="/blogs/assets/js/78.3417b478.js" defer></script>
  </body>
</html>
